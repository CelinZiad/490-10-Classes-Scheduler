<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Catalog</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='design-system.css') }}">
</head>

<body>
<div class="app-layout">

  <aside class="sidebar">
    <a class="nav-item" href="{{ url_for('dashboard') }}">Dashboard</a>
    <a class="nav-item" href="{{ url_for('schedule') }}">Schedules</a>
    <a class="nav-item active" href="{{ url_for('catalog') }}">Catalog</a>
    <a class="nav-item" href="{{ url_for('conflicts') }}">Conflicts</a>
    <a class="nav-item" href="{{ url_for('solutions') }}">Solutions</a>

    <div class="nav-separator"></div>

    <div class="nav-item sub-item">Courses</div>
    <div class="nav-item sub-item">Rooms</div>
    <div class="nav-item sub-item">Instructors</div>
    <div class="nav-item sub-item">Constraints</div>
  </aside>

  <main class="main-content">
    <h1>Catalog View (by Sequence)</h1>

    <div class="card">
      <form method="GET" action="{{ url_for('catalog') }}" style="display:flex; gap:16px; align-items:flex-end; flex-wrap:wrap;">
        <div>
          <label for="planid">Sequence type</label><br>
          <select id="planid" name="planid" onchange="this.form.submit()">
            {% for p in plans %}
              <option value="{{ p.planid }}" {% if p.planid == selected_planid %}selected{% endif %}>
                {{ p.planname }}
              </option>
            {% endfor %}
          </select>
        </div>

        <div>
          <label for="termid">Semester</label><br>
          <select id="termid" name="termid" onchange="this.form.submit()">
            {% for t in terms %}
              <option value="{{ t.sequencetermid }}" {% if t.sequencetermid == selected_termid %}selected{% endif %}>
                Year {{ t.yearnumber }} {{ t.season|title }} {% if t.workterm %}(Work term){% endif %}
              </option>
            {% endfor %}
          </select>
        </div>

        <noscript>
          <button type="submit">Load</button>
        </noscript>
      </form>
    </div>

    <div class="card">
      {% if rows and rows|length > 0 %}
        <table class="data-table">
          <thead>
            <tr>
              <th>Course</th>
              <th>Title</th>
              <th>Credits</th>
              <th>Elective</th>
              <th>Prerequisites</th>
            </tr>
          </thead>
          <tbody>
            {% for r in rows %}
              <tr>
                <td>{{ r.subject }} {{ r.catalog }}</td>
                <td>{{ r.title if r.title else "Not found in catalog" }}</td>
                <td>{{ r.classunit if r.classunit is not none else "-" }}</td>
                <td>{{ "Yes" if r.iselective else "No" }}</td>
                <td style="max-width: 520px;">
                  {{ r.prerequisites if r.prerequisites else "-" }}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p>No courses found for this selection.</p>
      {% endif %}
    </div>

  </main>
</div>
</body>
</html>
